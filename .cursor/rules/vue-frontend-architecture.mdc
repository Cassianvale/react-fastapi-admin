description:
globs:
alwaysApply: false

---

# Vue3 å‰ç«¯æ¶æ„è§„èŒƒ

è¿™æ˜¯åŸºäº Vue3 + Naive UI + Pinia çš„ç°ä»£å‰ç«¯ç®¡ç†ç³»ç»Ÿæ¶æ„è§„èŒƒã€‚

## ğŸ—ï¸ å‰ç«¯æ¶æ„è®¾è®¡

### æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Vue 3 (Composition API)
- **UI åº“**: Naive UI
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router 4
- **æ„å»ºå·¥å…·**: Vite
- **æ ·å¼**: SCSS + UnoCSS
- **å›½é™…åŒ–**: Vue I18n

### ç›®å½•ç»“æ„è¯´æ˜

#### `/web/src` - å‰ç«¯æºç ç›®å½•

- **å…¥å£æ–‡ä»¶**: [web/src/main.js](mdc:web/src/main.js) - åº”ç”¨å¯åŠ¨å…¥å£
- **æ ¹ç»„ä»¶**: [web/src/App.vue](mdc:web/src/App.vue) - åº”ç”¨æ ¹ç»„ä»¶

#### `/web/src/api` - API æ¥å£å±‚

- ç»Ÿä¸€çš„ API è¯·æ±‚å°è£…
- æ¥å£å®šä¹‰å’Œè°ƒç”¨ç®¡ç†

#### `/web/src/components` - ç»„ä»¶å±‚

- **é€šç”¨ç»„ä»¶**: [web/src/components/common/](mdc:web/src/components/common/) - è·¨é¡µé¢å¤ç”¨ç»„ä»¶
- **å›¾æ ‡ç»„ä»¶**: [web/src/components/icon/](mdc:web/src/components/icon/) - å›¾æ ‡ç›¸å…³ç»„ä»¶
- **é¡µé¢ç»„ä»¶**: [web/src/components/page/](mdc:web/src/components/page/) - é¡µé¢çº§ç»„ä»¶
- **æŸ¥è¯¢ç»„ä»¶**: [web/src/components/query-bar/](mdc:web/src/components/query-bar/) - æŸ¥è¯¢æ ç»„ä»¶
- **è¡¨æ ¼ç»„ä»¶**: [web/src/components/table/](mdc:web/src/components/table/) - è¡¨æ ¼ç›¸å…³ç»„ä»¶

#### `/web/src/layout` - å¸ƒå±€ç»„ä»¶

- [web/src/layout/index.vue](mdc:web/src/layout/index.vue) - ä¸»å¸ƒå±€å®¹å™¨
- **å¤´éƒ¨ç»„ä»¶**: [web/src/layout/components/header/](mdc:web/src/layout/components/header/) - é¡¶éƒ¨å¯¼èˆªæ 
- **ä¾§è¾¹æ **: [web/src/layout/components/sidebar/](mdc:web/src/layout/components/sidebar/) - ä¾§è¾¹èœå•
- **æ ‡ç­¾æ **: [web/src/layout/components/tags/](mdc:web/src/layout/components/tags/) - é¡µé¢æ ‡ç­¾å¯¼èˆª

#### `/web/src/router` - è·¯ç”±ç®¡ç†

- [web/src/router/index.js](mdc:web/src/router/index.js) - è·¯ç”±é…ç½®
- **è·¯ç”±å®ˆå«**: [web/src/router/guard/](mdc:web/src/router/guard/) - å¯¼èˆªå®ˆå«é€»è¾‘
- **è·¯ç”±å®šä¹‰**: [web/src/router/routes/](mdc:web/src/router/routes/) - è·¯ç”±è¡¨å®šä¹‰

#### `/web/src/store` - çŠ¶æ€ç®¡ç† (Pinia)

- [web/src/store/index.js](mdc:web/src/store/index.js) - Store é…ç½®
- **ç”¨æˆ·æ¨¡å—**: [web/src/store/modules/user/](mdc:web/src/store/modules/user/) - ç”¨æˆ·çŠ¶æ€ç®¡ç†
- **åº”ç”¨æ¨¡å—**: [web/src/store/modules/app/](mdc:web/src/store/modules/app/) - åº”ç”¨è®¾ç½®çŠ¶æ€
- **æƒé™æ¨¡å—**: [web/src/store/modules/permission/](mdc:web/src/store/modules/permission/) - æƒé™è·¯ç”±ç®¡ç†
- **æ ‡ç­¾æ¨¡å—**: [web/src/store/modules/tags/](mdc:web/src/store/modules/tags/) - é¡µé¢æ ‡ç­¾çŠ¶æ€

#### `/web/src/views` - é¡µé¢è§†å›¾

- **å·¥ä½œå°**: [web/src/views/workbench/](mdc:web/src/views/workbench/) - ä»ªè¡¨æ¿é¡µé¢
- **ç™»å½•é¡µ**: [web/src/views/login/](mdc:web/src/views/login/) - ç™»å½•è®¤è¯é¡µé¢
- **ç³»ç»Ÿç®¡ç†**: [web/src/views/system/](mdc:web/src/views/system/) - ç³»ç»Ÿç®¡ç†é¡µé¢é›†åˆ
- **é”™è¯¯é¡µé¢**: [web/src/views/error-page/](mdc:web/src/views/error-page/) - é”™è¯¯é¡µé¢é›†åˆ

## ğŸ¨ ç»„ä»¶å¼€å‘è§„èŒƒ

### Vue 3 Composition API è§„èŒƒ

```vue
<script setup>
import { ref, reactive, computed, onMounted } from "vue";
import { useRouter } from "vue-router";
import { useMessage } from "naive-ui";

// Props å®šä¹‰
const props = defineProps({
  title: {
    type: String,
    default: "",
  },
  data: {
    type: Array,
    default: () => [],
  },
});

// Emits å®šä¹‰
const emit = defineEmits(["update", "delete"]);

// å“åº”å¼æ•°æ®
const loading = ref(false);
const formData = reactive({
  name: "",
  email: "",
});

// è®¡ç®—å±æ€§
const totalCount = computed(() => props.data.length);

// æ–¹æ³•å®šä¹‰
const handleSubmit = async () => {
  loading.value = true;
  try {
    // ä¸šåŠ¡é€»è¾‘
    emit("update", formData);
  } finally {
    loading.value = false;
  }
};

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // åˆå§‹åŒ–é€»è¾‘
});
</script>

<template>
  <div class="container">
    <!-- æ¨¡æ¿å†…å®¹ -->
  </div>
</template>

<style scoped lang="scss">
.container {
  // æ ·å¼å®šä¹‰
}
</style>
```

### ç»„ä»¶å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**: ä½¿ç”¨ `PascalCase` (å¦‚: `UserList.vue`)
- **ç»„ä»¶åç§°**: ä½¿ç”¨ `PascalCase` (å¦‚: `<UserList />`)
- **Props**: ä½¿ç”¨ `camelCase`
- **Events**: ä½¿ç”¨ `kebab-case`

## ğŸ”„ çŠ¶æ€ç®¡ç† (Pinia) è§„èŒƒ

### Store å®šä¹‰æ¨¡å¼

```javascript
import { defineStore } from "pinia";
import { ref, computed } from "vue";

export const useUserStore = defineStore("user", () => {
  // State
  const userInfo = ref(null);
  const token = ref("");

  // Getters (Computed)
  const isLoggedIn = computed(() => !!token.value);
  const userName = computed(() => userInfo.value?.username || "");

  // Actions
  const login = async (credentials) => {
    try {
      // ç™»å½•é€»è¾‘
      const response = await loginApi(credentials);
      token.value = response.token;
      userInfo.value = response.user;
    } catch (error) {
      throw error;
    }
  };

  const logout = () => {
    token.value = "";
    userInfo.value = null;
  };

  return {
    // State
    userInfo,
    token,
    // Getters
    isLoggedIn,
    userName,
    // Actions
    login,
    logout,
  };
});
```

### Store ä½¿ç”¨è§„èŒƒ

```vue
<script setup>
import { useUserStore } from "@/store/modules/user";

const userStore = useUserStore();

// è®¿é—®çŠ¶æ€
const { userInfo, isLoggedIn } = storeToRefs(userStore);

// è°ƒç”¨æ–¹æ³•
const handleLogin = async () => {
  await userStore.login(credentials);
};
</script>
```

## ğŸ› ï¸ å·¥å…·å‡½æ•°å’Œ Composables

### Composables è§„èŒƒ

```javascript
// composables/useCRUD.js
import { ref, reactive } from "vue";
import { useMessage } from "naive-ui";

export function useCRUD(api) {
  const loading = ref(false);
  const data = ref([]);
  const pagination = reactive({
    page: 1,
    pageSize: 10,
    total: 0,
  });

  const message = useMessage();

  const fetchData = async () => {
    loading.value = true;
    try {
      const response = await api.list(pagination);
      data.value = response.data;
      pagination.total = response.total;
    } catch (error) {
      message.error("è·å–æ•°æ®å¤±è´¥");
    } finally {
      loading.value = false;
    }
  };

  const create = async (formData) => {
    try {
      await api.create(formData);
      message.success("åˆ›å»ºæˆåŠŸ");
      fetchData();
    } catch (error) {
      message.error("åˆ›å»ºå¤±è´¥");
    }
  };

  return {
    loading,
    data,
    pagination,
    fetchData,
    create,
  };
}
```

## ğŸ¯ è·¯ç”±å’Œæƒé™ç®¡ç†

### è·¯ç”±å®šä¹‰è§„èŒƒ

```javascript
// router/routes/system.js
export default [
  {
    path: "/system",
    name: "System",
    component: () => import("@/layout/index.vue"),
    meta: {
      title: "ç³»ç»Ÿç®¡ç†",
      icon: "system",
      requiresAuth: true,
    },
    children: [
      {
        path: "user",
        name: "SystemUser",
        component: () => import("@/views/system/user/index.vue"),
        meta: {
          title: "ç”¨æˆ·ç®¡ç†",
          permissions: ["system:user:view"],
        },
      },
    ],
  },
];
```

### æƒé™æ£€æŸ¥

```javascript
// router/guard/auth-guard.js
import { useUserStore } from "@/store/modules/user";

export function setupAuthGuard(router) {
  router.beforeEach((to, from, next) => {
    const userStore = useUserStore();

    if (to.meta.requiresAuth && !userStore.isLoggedIn) {
      next("/login");
      return;
    }

    if (to.meta.permissions) {
      const hasPermission = userStore.hasPermissions(to.meta.permissions);
      if (!hasPermission) {
        next("/403");
        return;
      }
    }

    next();
  });
}
```

## ğŸ¨ æ ·å¼å’Œä¸»é¢˜è§„èŒƒ

### SCSS ç»„ç»‡

```scss
// styles/global.scss
@import "./variables.scss";
@import "./mixins.scss";
@import "./reset.css";

// å…¨å±€æ ·å¼
body {
  font-family: $font-family-base;
  color: $text-color-primary;
}

// å·¥å…·ç±»
.text-center {
  text-align: center;
}
.flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}
```

### UnoCSS ä½¿ç”¨

```vue
<template>
  <div class="p-4 bg-white rounded-lg shadow-md">
    <h1 class="text-xl font-bold mb-4">æ ‡é¢˜</h1>
    <div class="flex items-center justify-between">
      <!-- å†…å®¹ -->
    </div>
  </div>
</template>
```

## ğŸ“± å“åº”å¼è®¾è®¡

### æ–­ç‚¹è§„èŒƒ

- **xs**: < 480px (æ‰‹æœº)
- **sm**: 480px - 768px (å¤§æ‰‹æœº/å°å¹³æ¿)
- **md**: 768px - 1024px (å¹³æ¿)
- **lg**: 1024px - 1280px (å°æ¡Œé¢)
- **xl**: > 1280px (å¤§æ¡Œé¢)

### å“åº”å¼ç»„ä»¶

```vue
<template>
  <div class="responsive-container">
    <div class="hidden md:block">æ¡Œé¢ç‰ˆå†…å®¹</div>
    <div class="block md:hidden">ç§»åŠ¨ç‰ˆå†…å®¹</div>
  </div>
</template>
```

## ğŸ” æœ€ä½³å®è·µ

### æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨ `v-show` vs `v-if` çš„åœºæ™¯é€‰æ‹©
- ç»„ä»¶æ‡’åŠ è½½å’Œä»£ç åˆ†å‰²
- è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§åˆ—è¡¨
- å›¾ç‰‡æ‡’åŠ è½½å’Œå‹ç¼©

### ä»£ç è´¨é‡

- ä½¿ç”¨ TypeScript æä¾›ç±»å‹å®‰å…¨
- ESLint + Prettier ä»£ç æ ¼å¼åŒ–
- ç»„ä»¶å•å…ƒæµ‹è¯•è¦†ç›–
- æ¥å£ Mock å’Œæ•°æ®æ¨¡æ‹Ÿ

### å›½é™…åŒ–

```javascript
// i18n/messages/cn.json
{
  "common": {
    "save": "ä¿å­˜",
    "cancel": "å–æ¶ˆ",
    "confirm": "ç¡®è®¤"
  },
  "user": {
    "username": "ç”¨æˆ·å",
    "email": "é‚®ç®±åœ°å€"
  }
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
const { t } = useI18n()
const saveText = t('common.save')
```
